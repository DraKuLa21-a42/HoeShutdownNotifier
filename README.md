# Скрипт для отримання інформації про відключення електроенергії

Скрипт призначений для отримання інформації про графіки відключення електроенергії з сайту Хмельницькобленерго та відправки цієї інформації в Telegram або Slack.

## Отримання ID вулиці

Для того, щоб дізнатись ID своєї вулиці (для браузера Google Chrome):

1. Перейдіть на сторінку https://hoe.com.ua/shutdown/new.
2. Відкрийте консоль розробника (F12), перейдіть на вкладку "Мережа".
3. Введіть свою адресу на сайті.
4. У списку файлів знайдіть файл `shutdown-events`, та натисніть на нього.
5. В розділі "Обсяг даних" знайдіть значення для `streetId` і `house`, це необхідні дані для скрипта.

## Запуск скрипта

Скрипт запускається з командного рядка за допомогою:

```bash
git clone https://github.com/DraKuLa21-a42/HoeShutdownNotifier.git
cd HoeShutdownNotifier
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```
Створюєте файл зі змінними, як показано нижче.


Опис файлу:
```
SEND_TO="TG" # В який месенджер відправляти повідомлення. TG - Telegram, SLACK - Slack.
STREET_ID="123456" # ID вулиці.
HOUSE="12" # Номер будинку
TG_BOT_ID="bot6191234558:AAGWWpWtZUExAmPlEbpt3WkS8QzdcuQNq2DA" # ID бота в Telegram, який буде відправляти повідомлення.
TG_CHAT_ID="-1001553812345" # ID чата в Telegram, в який будуть приходити повідомлення.
TG_DIS_NOTIFY="true" # Повідомлення в Telegram з/без сповіщення. true - повідомлення прийде в тихому режимі, без звуку. false - повідомлення прийде у звичайному режимі.
SLACK_CNANNEL="C02EXAMPLE" # ID каналу в Slack, в який будуть приходити повідомлення.
SLACK_TOKEN="xoxb-2370012345-6315485354321-a8669EiJnp0JExAmPlELwOHg" # Токен бота в Slack, який буде відправляти повідомлення.
ENABLE_LOG="no" # Зберігання відповіді від сайту у файл.
SEND_GRAPHS="yes" # Додаткова функція. Відправка зображення з актуальними графіками відключень. Приклад в example.png
SEND_SHUTDOWN_EVENTS="yes" # Чи потрібно відправляти самі погодинні відключення. Можна вимикати, коли потрібно надсилати лише графіки.
DELAY="30" # Час, протягом якого скрипт буде очікувати відповіді від сайту.
RETRIES="10" # Кількість спроб, які скрипт буде робити, для отримання данних з сайту.
```
Додаєте завдання в crontab.
```bash
*/15 * * * * cd /path/to/script/HoeShutdownNotifier && source venv/bin/activate && CONFIG=home python3 HoeShutdownNotifier.py
```
Де `home` - назва файлу, зі змінними.
## Приклади повідомлень
Після успішного запуску скрипта, приклад повідомлення, яке можна отримати:

```
З'явились погодинні відключення!

Вид робіт: Графік погодинних відключень
Тип відключення: Аварійне
Черга (ГПВ): 2.2
Черга (ГАВ): -
Початок: 26.11.2025 14:00
Кінець: 26.11.2025 17:22
```

Якщо графіки відсутні, прийде повідомлення:
```
Погодинних відключень немає!
```

Якщо виникла якась помилка з завантаженням даних з сайту, прийде повідомлення:
```
Помилка отримання даних.
```
